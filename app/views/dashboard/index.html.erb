<h1>Dashboard</h1>
<%= select("filter", "currency", ['CAD', 'ILS', 'USD']) %>

<div class="filter_options_container">
  <form class="filter_form">
    <%= label_tag(:from, "from:") %>
    <%= select("filter", "from_year", 2013..2017, selected: @expenses.map(&:year).min) %>
    <%= select("filter", "from_month", 1..12, selected: @expenses.map(&:month).min) %>
    <%= label_tag(:to, "to:") %>
    <%= select("filter", "to_year", 2013..2017, selected: @expenses.map(&:year).max) %>
    <%= select("filter", "to_month", 1..12, selected: @expenses.map(&:month).max) %>
    <input type="submit" value="Filter" />
  </form>
</div>

<h3> Income in period: <%= @incomes.count %> </h3>
<h3> Expenses in period: <%= @expenses.count %> </h3>

<h3>Bucket: <%= WorkExpenseIn.all.map{|w| w.amount.to_d}.sum -  WorkExpenseOut.all.map{|w| w.amount.to_d}.sum %>$</h3>

<%= pie_chart @expenses.group_by{|i| i.category.hebrew_name}.map{|k,v| [k, v.map{|item| item.currency.convert_to('CAD', item.amount) }.sum.to_i]}, donut: true %>
